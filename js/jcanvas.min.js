/*
 jCanvas v14.01.01
 Copyright 2014 Caleb Evans
 Released under the MIT license
*/
(function(d,sa,ta,la,ba,ua,z,J,f,E){function M(c){V(this,c);return this}function K(c){c?V(M.prototype,c):K.prefs=M.prototype=V({},ha);return this}function ia(c){return"string"===ca(c)}function L(c){return c&&c.getContext?c.getContext("2d"):f}function ja(c){c=V({},c);c.masks=c.masks.slice(0);return c}function da(c,b){var a;c.save();a=ja(b.transforms);b.savedTransforms.push(a)}function S(c,b,a){Z(a.fillStyle)?b.fillStyle=a.fillStyle.call(c,a):b.fillStyle=a.fillStyle;Z(a.strokeStyle)?b.strokeStyle=a.strokeStyle.call(c,
a):b.strokeStyle=a.strokeStyle;b.lineWidth=a.strokeWidth;a.rounded?b.lineCap=b.lineJoin="round":(b.lineCap=a.strokeCap,b.lineJoin=a.strokeJoin,b.miterLimit=a.miterLimit);b.shadowOffsetX=a.shadowX;b.shadowOffsetY=a.shadowY;b.shadowBlur=a.shadowBlur;b.shadowColor=a.shadowColor;b.globalAlpha=a.opacity;b.globalCompositeOperation=a.compositing;a.imageSmoothing&&(b.webkitImageSmoothingEnabled=b.mozImageSmoothingEnabled=a.imageSmoothing)}function va(c,b,a){a.mask&&(a.autosave&&da(c,b),c.clip(),b.transforms.masks.push(a._args))}
function X(c,b,a){a.closed&&b.closePath();a.shadowStroke&&0!==a.strokeWidth?(b.stroke(),b.fill(),b.shadowColor="transparent",b.shadowBlur=0,b.stroke()):(b.fill(),"transparent"!==a.fillStyle&&(b.shadowColor="transparent"),0!==a.strokeWidth&&b.stroke());a.closed||b.closePath();a._transformed&&b.restore();a.mask&&(c=A(c),va(b,c,a))}function wa(c,b,a){b._toRad=b.inDegrees?N/180:1;c.translate(b.x,b.y);c.rotate(b.rotate*b._toRad);c.translate(-b.x,-b.y);a&&(a.rotate+=b.rotate*b._toRad)}function xa(c,b,a){1!==
b.scale&&(b.scaleX=b.scaleY=b.scale);c.translate(b.x,b.y);c.scale(b.scaleX,b.scaleY);c.translate(-b.x,-b.y);a&&(a.scaleX*=b.scaleX,a.scaleY*=b.scaleY)}function ya(c,b,a){b.translate&&(b.translateX=b.translateY=b.translate);c.translate(b.translateX,b.translateY);a&&(a.translateX+=b.translateX,a.translateY+=b.translateY)}function Q(c,b,a,e,g){a._toRad=a.inDegrees?N/180:1;a.arrowAngle*=a._toRad;a._transformed=z;b.save();a.fromCenter||a._centered||e===E||(g===E&&(g=e),a.x+=e/2,a.y+=g/2,a._centered=z);
a.rotate&&wa(b,a,{});1===a.scale&&1===a.scaleX&&1===a.scaleY||xa(b,a,{});(a.translate||a.translateX||a.translateY)&&ya(b,a,{})}function A(c){var b;ea._canvas===c&&ea._data?b=ea._data:(b=d.data(c,"jCanvas"),b||(b={canvas:c,layers:[],layer:{names:{},groups:{}},eventHooks:{},intersecting:[],lastIntersected:f,cursor:d(c).css("cursor"),drag:{layer:f,dragging:J},event:{type:f,x:f,y:f},events:{},transforms:ja(ma),savedTransforms:[],animating:J,animated:f,pixelRatio:1,scaled:!1},d.data(c,"jCanvas",b)),ea._canvas=
c,ea._data=b);return b}function za(c,b,a){for(var e in K.events)K.events.hasOwnProperty(e)&&(a[e]||a.cursors&&a.cursors[e])&&Aa(c,b,a,e)}function Aa(c,b,a,e){void 0!==window.ontouchstart&&na[e]&&(e=na[e]);K.events[e](c,b);a._event=z}function Ba(c,b,a){var e,g,h;if(a.draggable||a.cursor||a.cursors){e=["mousedown","mousemove","mouseup"];for(h=0;h<e.length;h+=1)g=e[h],Aa(c,b,a,g);b.events.mouseoutdrag||(c.bind("mouseout.jCanvas",function(){var a=b.drag.layer;a&&(b.drag={},P(c,b,a,"dragcancel"),c.drawLayers())}),
b.events.mouseoutdrag=z);a._event=z}}function ka(c,b,a,e){c=b.layer.names;e?e.name!==E&&ia(a.name)&&a.name!==e.name&&delete c[a.name]:e=a;ia(e.name)&&(c[e.name]=a)}function oa(c,b,a,e){c=b.layer.groups;var g,h,B,d;a.group!==f&&(a.groups=[a.group],a.dragGroupWithLayer&&(a.dragGroups=[a.group]));e&&e.group!==E&&(e.group===f?e.groups=f:(e.groups=[e.group],e.dragGroupWithLayer&&(e.dragGroups=[e.group])));if(!e)e=a;else if(e.groups!==E&&a.groups!==f)for(h=0;h<a.groups.length;h+=1)if(g=a.groups[h],b=c[g]){for(d=
0;d<b.length;d+=1)if(b[d]===a){B=d;b.splice(d,1);break}0===b.length&&delete c[g]}if(e.groups!==E&&e.groups!==f)for(h=0;h<e.groups.length;h+=1)g=e.groups[h],b=c[g],b||(b=c[g]=[],b.name=g),B===E&&(B=b.length),b.splice(B,0,a)}function P(c,b,a,e,g){if(!a.disableEvents){var h;h=a.cursors?a.cursors[e]:a.cursor;-1!==d.inArray(h,Ca)&&(h=Da.css+h);h&&c.css({cursor:h});a[e]&&a[e].call(c[0],a,g);b.eventHooks[e]&&b.eventHooks[e].call(c[0],a,g);K.eventHooks[e]&&K.eventHooks[e].call(c[0],a,g)}}function O(c,b,a,
e){var g=b;b._args=a;b.canvas=c;if(b.draggable||b.dragGroups)b.layer=z,b.draggable=z;b._method=e?e:b.method?d.fn[b.method]:b.type?d.fn[$[b.type]]:function(){};b.layer&&!b._layer&&(a=d(c),e=A(c),c=e.layers,g.name===f||ia(g.name)&&e.layer.names[g.name]===E)&&(g=new M(b),g.layer=z,g._layer=z,g._data=e,ka(a,e,g),oa(a,e,g),za(a,e,g),Ba(a,e,g),b._event=g._event,g.index===f&&(g.index=c.length),c.splice(g.index,0,g),b._args=g,P(a,e,g,"add"));return g}function Ea(c,b){var a,e;for(e=0;e<fa.length;e+=1)a=fa[e],
c["_"+a]=c[a],pa[a]=z,b&&delete c[a]}function La(c,b,a){for(var e in a)a.hasOwnProperty(e)&&Z(a[e])&&(a[e]=a[e].call(c,b,e));return a}function Fa(c){var b,a,e=[],g=1;c.match(/^(\w+|#[0-9a-f]+)$/gi)&&("transparent"===c&&(c="rgba(0,0,0,0)"),a=sa.head,b=a.style.color,a.style.color=c,c=d.css(a,"color"),a.style.color=b);c.match(/^rgb/gi)&&(e=c.match(/\d+/gi),c.match(/%/gi)&&(g=2.55),e[0]*=g,e[1]*=g,e[2]*=g,e[3]=e[3]!==E?ua(e[3]):1);return e}function Ma(c){var b=3,a;"array"!==ca(c.start)&&(c.start=Fa(c.start),
c.end=Fa(c.end));c.now=[];if(1!==c.start[3]||1!==c.end[3])b=4;for(a=0;a<b;a+=1)c.now[a]=c.start[a]+(c.end[a]-c.start[a])*c.pos,3>a&&(c.now[a]=Na(c.now[a]));1!==c.start[3]||1!==c.end[3]?c.now="rgba("+c.now.join(",")+")":(c.now.slice(0,3),c.now="rgb("+c.now.join(",")+")");c.elem.nodeName?c.elem.style[c.prop]=c.now:c.elem[c.prop]=c.now}function Oa(c){K.events[c]=function(b,a){var e,g;g=a.event;e="mouseover"===c||"mouseout"===c?"mousemove":c;a.events[e]||(b.bind(e+".jCanvas",function(a){g.x=a.offsetX;
g.y=a.offsetY;g.type=e;g.event=a;b.drawLayers({resetFire:z});a.preventDefault()}),a.events[e]=z)}}function U(c,b,a){var e,g,h,B;if(a=a._args)c=A(c),e=c.event,e.x!==f&&e.y!==f&&(h=e.x*c.pixelRatio,B=e.y*c.pixelRatio,g=b.isPointInPath(h,B)||b.isPointInStroke&&b.isPointInStroke(h,B)),b=c.transforms,a.eventX=a.mouseX=e.x,a.eventY=a.mouseY=e.y,a.event=e.event,e=c.transforms.rotate,h=a.eventX,B=a.eventY,0!==e?(a._eventX=h*R(-e)-B*T(-e),a._eventY=B*R(-e)+h*T(-e)):(a._eventX=h,a._eventY=B),a._eventX/=b.scaleX,
a._eventY/=b.scaleY,g&&c.intersecting.push(a),a.intersects=g}function Ga(c){for(;0>c;)c+=2*N;return c}function Ha(c,b,a,e,g,h,B){var d,f,v;a.arrowRadius&&!a.closed&&(v=Pa(B-g,h-e),v-=N,d=a.strokeWidth*R(v),f=a.strokeWidth*T(v),c=h+a.arrowRadius*R(v+a.arrowAngle/2),e=B+a.arrowRadius*T(v+a.arrowAngle/2),g=h+a.arrowRadius*R(v-a.arrowAngle/2),a=B+a.arrowRadius*T(v-a.arrowAngle/2),b.moveTo(c-d,e-f),b.lineTo(h-d,B-f),b.lineTo(g-d,a-f),b.moveTo(h-d,B-f),b.lineTo(h+d,B+f))}function ga(c,b,a,e,g,h,d,f,F,v,
H){a.startArrow&&Ha(c,b,a,e,g,h,d);a.endArrow&&Ha(c,b,a,f,F,v,H)}function Ia(c,b){isNaN(Number(b.fontSize))||(b.fontSize+="px");c.font=b.fontStyle+" "+b.fontSize+" "+b.fontFamily}function Ja(c,b,a,e){var g,h;if(Y.text===a.text&&Y.fontStyle===a.fontStyle&&Y.fontSize===a.fontSize&&Y.fontFamily===a.fontFamily&&Y.maxWidth===a.maxWidth&&Y.lineHeight===a.lineHeight)a.width=Y.width,a.height=Y.height;else{a.width=b.measureText(e[0]).width;for(h=1;h<e.length;h+=1)g=b.measureText(e[h]).width,g>a.width&&(a.width=
g);b=c.style.fontSize;c.style.fontSize=a.fontSize;a.height=ua(d.css(c,"fontSize"))*e.length*a.lineHeight;c.style.fontSize=b}}function Ka(c,b){var a=b.maxWidth,e=b.text.split("\n"),g=[],h,d,f,F,v;for(f=0;f<e.length;f+=1){F=e[f];v=F.split(" ");h=[];d="";if(1===v.length||c.measureText(F).width<a)h=[F];else{for(F=0;F<v.length;F+=1)c.measureText(d+v[F]).width>a&&(""!==d&&h.push(d),d=""),d+=v[F],F!==v.length-1&&(d+=" ");h.push(d)}g=g.concat(h.join("\n").replace(/( (\n))|( $)/gi,"$2").split("\n"))}return g}
var ha,V=d.extend,aa=d.inArray,ca=d.type,Z=d.isFunction,Na=ba.round,N=ba.PI,T=ba.sin,R=ba.cos,Pa=ba.atan2,Qa=d.event.fix,na,qa,$,ea={},Y={},ra={},ma={rotate:0,scaleX:1,scaleY:1,translateX:0,translateY:0,masks:[]},fa,pa,Ca,Da;d.fn.jCanvas=K;K.events={};K.eventHooks={};ha={align:"center",arrowAngle:90,arrowRadius:0,autosave:z,baseline:"middle",bringToFront:J,ccw:J,closed:J,compositing:"source-over",concavity:0,cornerRadius:0,count:1,cropFromCenter:z,cursor:f,cursors:f,disableEvents:J,draggable:J,dragGroups:f,
group:f,groups:f,data:{},dx:f,dy:f,each:f,end:360,eventX:f,eventY:f,fillStyle:"transparent",fontStyle:"normal",fontSize:"12pt",fontFamily:"sans-serif",fromCenter:z,fn:f,height:f,imageSmoothing:z,inDegrees:z,index:f,lineHeight:1,layer:J,mask:J,maxWidth:f,miterLimit:10,name:f,opacity:1,r1:f,r2:f,radius:0,repeat:"repeat",respectAlign:J,rotate:0,rounded:J,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:"transparent",shadowStroke:!1,shadowX:0,shadowY:0,sHeight:f,sides:0,source:"",spread:0,start:0,strokeCap:"butt",
strokeJoin:"miter",strokeStyle:"transparent",strokeWidth:1,sWidth:f,sx:f,sy:f,text:"",translate:0,translateX:0,translateY:0,type:f,visible:z,width:f,x:0,y:0};K();K.extend=function(c){K.defaults=V(ha,c.props);K();c.name&&(d.fn[c.name]=function a(e){var g,h,d,f;for(h=0;h<this.length;h+=1)if(g=this[h],d=L(g))f=new M(e),O(g,f,e,a),S(g,d,f),c.fn.call(g,d,f);return this},c.type&&$[c.type]===E&&($[c.type]=c.name));return d.fn[c.name]};d.fn.getLayers=function(c){var b=this[0],a,e,g=[];if(b&&b.getContext)if(a=
A(b),a=a.layers,Z(c))for(e=0;e<a.length;e+=1)c.call(b,a[e])&&g.push(a[e]);else g=a;return g};d.fn.getLayer=function(c){var b=A(this[0]),a=b.layers,e=ca(c),g;if(c&&c.layer)g=c;else if("number"===e)0>c&&(c=a.length+c),g=a[c];else if("regexp"===e)for(b=0;b<a.length;b+=1){if(ia(a[b].name)&&a[b].name.match(c)){g=a[b];break}}else g=b.layer.names[c];return g};d.fn.getLayerGroup=function(c){var b=this[0],a=ca(c),e,g;if("array"===a)return c;if("regexp"===a)for(e in b=A(b),b=b.groups,b){if(e.match(c)){g=b[e];
break}}else b=A(b),g=b.layer.groups[c];return g};d.fn.getLayerIndex=function(c){var b=this.getLayers();c=this.getLayer(c);return aa(c,b)};d.fn.getEventHooks=function(){return A(this[0]).eventHooks};d.fn.setLayer=function(c,b){var a,e,g,h;for(e=0;e<this.length;e+=1)if(a=d(this[e]),g=A(this[e]),h=d(this[e]).getLayer(c))ka(a,g,h,b),oa(a,g,h,b),V(h,b),za(a,g,h),Ba(a,g,h),!1===d.isEmptyObject(b)&&P(a,g,h,"change",b);return this};d.fn.setLayers=function(c,b){var a,e,g,h;for(e=0;e<this.length;e+=1)for(a=
d(this[e]),g=a.getLayers(b),h=0;h<g.length;h+=1)a.setLayer(g[h],c);return this};d.fn.setLayerGroup=function(c,b){var a,e,g,h;for(e=0;e<this.length;e+=1)if(a=d(this[e]),g=a.getLayerGroup(c))for(h=0;h<g.length;h+=1)a.setLayer(g[h],b);return this};d.fn.setEventHooks=function(c){var b,a;for(b=0;b<this.length;b+=1)d(this[b]),a=A(this[b]),V(a.eventHooks,c);return this};d.fn.moveLayer=function(c,b){var a,e,g,h,f;for(e=0;e<this.length;e+=1)if(a=d(this[e]),g=A(this[e]),h=g.layers,f=a.getLayer(c))f.index=aa(f,
h),h.splice(f.index,1),h.splice(b,0,f),0>b&&(b=h.length+b),f.index=b,P(a,g,f,"move");return this};d.fn.removeLayer=function(c){var b,a,e,g,h;for(a=0;a<this.length;a+=1)if(b=d(this[a]),e=A(this[a]),g=b.getLayers(),h=b.getLayer(c))h.index=aa(h,g),g.splice(h.index,1),ka(b,e,h,{name:f}),oa(b,e,h,{groups:f}),P(b,e,h,"remove");return this};d.fn.removeLayers=function(c){var b,a,e,g,h,f;for(a=0;a<this.length;a+=1){b=d(this[a]);e=A(this[a]);g=b.getLayers(c);for(f=0;f<g.length;f+=1)h=g[f],b.removeLayer(h),
f-=1;e.layer.names={};e.layer.groups={}}return this};d.fn.removeLayerGroup=function(c){var b,a,e,g,h,B,G;if(c!==E)for(a=0;a<this.length;a+=1)if(b=d(this[a]),e=A(this[a]),g=b.getLayers(),h=b.getLayerGroup(c)){for(G=0;G<h.length;G+=1)B=h[G],B.index=aa(B,g),g.splice(B.index,1),ka(b,e,B,{name:f});delete e.layer.groups[h.name]}return this};d.fn.addLayerToGroup=function(c,b){var a,e,g,h=[];for(e=0;e<this.length;e+=1)a=d(this[e]),g=a.getLayer(c),g.groups&&-1===aa(b,g.groups)&&(h=g.groups.slice(0),h.push(b),
a.setLayer(g,{groups:h}));return this};d.fn.removeLayerFromGroup=function(c,b){var a,e,g,h=[],f;for(e=0;e<this.length;e+=1)a=d(this[e]),g=a.getLayer(c),f=aa(b,g.groups),-1!==f&&(h=g.groups.slice(0),h.splice(f,1),a.setLayer(g,{groups:h}));return this};d.fn.drawLayer=function(c){var b,a,e;for(b=0;b<this.length;b+=1)a=d(this[b]),L(this[b]),(e=a.getLayer(c))&&e.visible&&e._method&&(e._next=f,e._method.call(a,e));return this};Ca=["grab","grabbing","zoom-in","zoom-out"];Da=function(){var c=getComputedStyle(sa.documentElement,
""),c=(la.prototype.slice.call(c).join("").match(/-(moz|webkit|ms)-/)||""===c.OLink&&["","o"])[1];return{lowercase:c,css:"-"+c+"-",js:c[0].toUpperCase()+c.substr(1)}}();d.fn.triggerLayerEvent=function(c,b){var a,e,g;for(e=0;e<this.length;e+=1)a=d(this[e]),g=A(this[e]),(c=a.getLayer(c))&&P(a,g,c,b);return this};d.fn.drawLayers=function(c){var b,a,e=V({},c),g,h,B,G,F,v;e.index||(e.index=0);for(b=0;b<this.length;b+=1)if(c=d(this[b]),a=L(this[b])){G=A(this[b]);e.clear!==J&&c.clearCanvas();a=G.layers;
for(B=e.index;B<a.length&&(g=a[B],g.index=B,e.resetFire&&(g._fired=J),F=c,v=g,h=B+1,v&&v.visible&&v._method&&(v._next=h?h:f,v._method.call(F,v)),g._masks=G.transforms.masks.slice(0),g._method!==d.fn.drawImage||!g.visible);B+=1);g=G;var H=h=v=F=void 0;F=f;for(v=g.intersecting.length-1;0<=v;v-=1)if(F=g.intersecting[v],F._masks){for(H=F._masks.length-1;0<=H;H-=1)if(h=F._masks[H],!h.intersects){F.intersects=J;break}if(F.intersects)break}g=F;F=G.event;v=F.type;if(G.drag.layer){h=c;var H=G,I=v,x=void 0,
n=void 0,r=void 0,y=r=void 0,q=void 0,r=x=x=r=void 0,r=H.drag,y=(n=r.layer)&&n.dragGroups||[],x=H.layers;if("mousemove"===I||"touchmove"===I){if(r.dragging||(r.dragging=z,n.bringToFront&&(x.splice(n.index,1),n.index=x.push(n)),n._startX=n.x,n._startY=n.y,n._endX=n._eventX,n._endY=n._eventY,P(h,H,n,"dragstart")),r.dragging)for(x=n._eventX-(n._endX-n._startX),r=n._eventY-(n._endY-n._startY),n.dx=x-n.x,n.dy=r-n.y,n.x=x,n.y=r,P(h,H,n,"drag"),x=0;x<y.length;x+=1)if(r=y[x],q=H.layer.groups[r],n.groups&&
q)for(r=0;r<q.length;r+=1)q[r]!==n&&(q[r].x+=n.dx,q[r].y+=n.dy)}else if("mouseup"===I||"touchend"===I)r.dragging&&(P(h,H,n,"dragstop"),r.dragging=J),H.drag={}}h=G.lastIntersected;h===f||g===h||!h._hovered||h._fired||G.drag.dragging||(G.lastIntersected=f,h._fired=z,h._hovered=J,P(c,G,h,"mouseout"),c.css({cursor:G.cursor}));g&&(g[v]||qa[v]&&(v=qa[v]),g._event&&g.intersects&&(G.lastIntersected=g,!(g.mouseover||g.mouseout||g.cursor||g.cursors&&!G.drag.dragging)||g._hovered||g._fired||(g._fired=z,g._hovered=
z,P(c,G,g,"mouseover")),g._fired||(g._fired=z,F.type=f,P(c,G,g,v)),!g.draggable||g.disableEvents||"mousedown"!==v&&"touchstart"!==v||(G.drag.layer=g)));g!==f||G.drag.dragging||c.css({cursor:G.cursor});B===a.length&&(G.intersecting.length=0,G.transforms=ja(ma),G.savedTransforms.length=0)}return this};d.fn.addLayer=function(c){var b,a;for(b=0;b<this.length;b+=1)if(a=L(this[b]))a=new M(c),a.layer=z,O(this[b],a,c);return this};fa=["width","height","opacity","lineHeight"];pa={};d.fn.animateLayer=function(){function c(a,
b,c){return function(){var e,g;for(g=0;g<fa.length;g+=1)e=fa[g],c[e]=c["_"+e];b.animating&&b.animated!==c||a.drawLayers();c._animating=J;b.animating=J;b.animated=f;h[4]&&h[4].call(a[0],c);P(a,b,c,"animateend")}}function b(a,b,c){return function(e,g){"_"===g.prop[0]&&(g=V({},g),g.prop=g.prop.replace("_",""),c[g.prop]=c["_"+g.prop]);c._pos!==g.pos&&(c._pos=g.pos,c._animating||b.animating||(c._animating=z,b.animating=z,b.animated=c),b.animating&&b.animated!==c||a.drawLayers());h[5]&&h[5].call(a[0],e,
g,c);P(a,b,c,"animate",g)}}var a,e,g,h=la.prototype.slice.call(arguments,0),B,G;"object"===ca(h[2])?(h.splice(2,0,h[2].duration||f),h.splice(3,0,h[3].easing||f),h.splice(4,0,h[4].done||h[4].complete||f),h.splice(5,0,h[5].step||f)):(h[2]===E?(h.splice(2,0,f),h.splice(3,0,f),h.splice(4,0,f)):Z(h[2])&&(h.splice(2,0,f),h.splice(3,0,f)),h[3]===E?(h[3]=f,h.splice(4,0,f)):Z(h[3])&&h.splice(3,0,f));for(e=0;e<this.length;e+=1)if(a=d(this[e]),g=L(this[e]))g=A(this[e]),(B=a.getLayer(h[0]))&&B._method!==d.fn.draw&&
(G=V({},h[1]),G=La(this[e],B,G),Ea(G,z),Ea(B),B.style=pa,d(B).animate(G,{duration:h[2],easing:d.easing[h[3]]?h[3]:f,complete:c(a,g,B),step:b(a,g,B)}),P(a,g,B,"animatestart"));return this};d.fn.animateLayerGroup=function(c){var b,a,e=la.prototype.slice.call(arguments,0),g,h;for(a=0;a<this.length;a+=1)if(b=d(this[a]),g=b.getLayerGroup(c))for(h=0;h<g.length;h+=1)b.animateLayer.apply(b,[g[h]].concat(e.slice(1)));return this};d.fn.delayLayer=function(c,b){var a,e,g,h;b=b||0;for(e=0;e<this.length;e+=1)if(a=
d(this[e]),g=A(this[e]),h=a.getLayer(c))d(h).delay(b),P(a,g,h,"delay");return this};d.fn.delayLayerGroup=function(c,b){var a,e,g,h,f;for(e=0;e<this.length;e+=1)if(a=d(this[e]),g=a.getLayerGroup(c))for(f=0;f<g.length;f+=1)h=g[f],a.delayLayer(h);return this};d.fn.stopLayer=function(c,b){var a,e,g,h;for(e=0;e<this.length;e+=1)if(a=d(this[e]),g=A(this[e]),h=a.getLayer(c))d(h).stop(b),P(a,g,h,"stop");return this};d.fn.stopLayerGroup=function(c,b){var a,e,g,h,f;for(e=0;e<this.length;e+=1)if(a=d(this[e]),
g=a.getLayerGroup(c))for(f=0;f<g.length;f+=1)h=g[f],a.stopLayer(h,b);return this};(function(c){var b;for(b=0;b<c.length;b+=1)d.fx.step[c[b]]=Ma})("color backgroundColor borderColor borderTopColor borderRightColor borderBottomColor borderLeftColor fillStyle outlineColor strokeStyle shadowColor".split(" "));na={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"};qa={touchstart:"mousedown",touchend:"mouseup",touchmove:"mousemove"};(function(c){var b;for(b=0;b<c.length;b+=1)Oa(c[b])})("click dblclick mousedown mouseup mousemove mouseover mouseout touchstart touchmove touchend".split(" "));
d.event.fix=function(c){var b,a;c=Qa.call(d.event,c);if(b=c.originalEvent)if(a=b.changedTouches,c.pageX!==E&&c.offsetX===E){if(b=d(c.currentTarget).offset())c.offsetX=c.pageX-b.left,c.offsetY=c.pageY-b.top}else a&&(b=d(c.currentTarget).offset())&&(c.offsetX=a[0].pageX-b.left,c.offsetY=a[0].pageY-b.top);return c};$={arc:"drawArc",bezier:"drawBezier",circle:"drawArc",ellipse:"drawEllipse","function":"draw",image:"drawImage",line:"drawLine",polygon:"drawPolygon",slice:"drawSlice",quadratic:"drawQuadratic",
rectangle:"drawRect",text:"drawText",vector:"drawVector"};d.fn.draw=function b(a){var e,g,h=new M(a);if($[h.type])this[$[h.type]](a);else for(e=0;e<this.length;e+=1)if(d(this[e]),g=L(this[e]))h=new M(a),O(this[e],h,a,b),h.visible&&h.fn&&h.fn.call(this[e],g,h);return this};d.fn.clearCanvas=function a(e){var g,h,d=new M(e);for(g=0;g<this.length;g+=1)if(h=L(this[g]))d.width===f||d.height===f?(h.save(),h.setTransform(1,0,0,1,0,0),h.clearRect(0,0,this[g].width,this[g].height),h.restore()):(O(this[g],d,
e,a),Q(this[g],h,d,d.width,d.height),h.clearRect(d.x-d.width/2,d.y-d.height/2,d.width,d.height),d._transformed&&h.restore());return this};d.fn.saveCanvas=function e(g){var h,d,f,F,v;for(h=0;h<this.length;h+=1)if(d=L(this[h]))for(F=A(this[h]),f=new M(g),O(this[h],f,g,e),v=0;v<f.count;v+=1)da(d,F);return this};d.fn.restoreCanvas=function g(h){var d,f,F,v,H;for(d=0;d<this.length;d+=1)if(f=L(this[d]))for(v=A(this[d]),F=new M(h),O(this[d],F,h,g),H=0;H<F.count;H+=1){var I=f,x=v;0===x.savedTransforms.length?
x.transforms=ja(ma):(I.restore(),x.transforms=x.savedTransforms.pop())}return this};d.fn.restoreCanvasOnRedraw=function(g){g=V({},g);g.layer=z;this.restoreCanvas(g);return this};d.fn.rotateCanvas=function h(d){var f,F,v,H;for(f=0;f<this.length;f+=1)if(F=L(this[f]))H=A(this[f]),v=new M(d),O(this[f],v,d,h),v.autosave&&da(F,H),wa(F,v,H.transforms);return this};d.fn.scaleCanvas=function B(d){var f,v,H,I;for(f=0;f<this.length;f+=1)if(v=L(this[f]))I=A(this[f]),H=new M(d),O(this[f],H,d,B),H.autosave&&da(v,
I),xa(v,H,I.transforms);return this};d.fn.translateCanvas=function G(d){var f,H,I,x;for(f=0;f<this.length;f+=1)if(H=L(this[f]))x=A(this[f]),I=new M(d),O(this[f],I,d,G),I.autosave&&da(H,x),ya(H,I,x.transforms);return this};d.fn.drawRect=function F(d){var f,I,x,n,r,y,q,t;for(f=0;f<this.length;f+=1)if(I=L(this[f]))x=new M(d),O(this[f],x,d,F),x.visible&&(S(this[f],I,x),Q(this[f],I,x,x.width,x.height),I.beginPath(),n=x.x-x.width/2,r=x.y-x.height/2,(t=x.cornerRadius)?(y=x.x+x.width/2,q=x.y+x.height/2,0>
y-n-2*t&&(t=(y-n)/2),0>q-r-2*t&&(t=(q-r)/2),I.moveTo(n+t,r),I.lineTo(y-t,r),I.arc(y-t,r+t,t,3*N/2,2*N,J),I.lineTo(y,q-t),I.arc(y-t,q-t,t,0,N/2,J),I.lineTo(n+t,q),I.arc(n+t,q-t,t,N/2,N,J),I.lineTo(n,r+t),I.arc(n+t,r+t,t,N,3*N/2,J),x.closed=z):I.rect(n,r,x.width,x.height),U(this[f],I,x),X(this[f],I,x));return this};d.fn.drawArc=function v(f){var d,x,n,r,y,q,t,p,l,k,m;for(d=0;d<this.length;d+=1)if(x=L(this[d]))n=new M(f),O(this[d],n,f,v),n.visible&&(S(this[d],x,n),Q(this[d],x,n,2*n.radius),n.inDegrees||
360!==n.end||(n.end=2*N),n.start*=n._toRad,n.end*=n._toRad,n.start-=N/2,n.end-=N/2,x.beginPath(),x.arc(n.x,n.y,n.radius,n.start,n.end,n.ccw),l=N/180*1,n.ccw&&(l*=-1),r=n.x+n.radius*R(n.start+l),y=n.y+n.radius*T(n.start+l),q=n.x+n.radius*R(n.start),t=n.y+n.radius*T(n.start),p=n.x+n.radius*R(n.end+l),l=n.y+n.radius*T(n.end+l),k=n.x+n.radius*R(n.end),m=n.y+n.radius*T(n.end),ga(this[d],x,n,r,y,q,t,k,m,p,l),U(this[d],x,n),X(this[d],x,n));return this};d.fn.drawEllipse=function H(d){var f,n,r,y,q;for(f=
0;f<this.length;f+=1)if(n=L(this[f]))r=new M(d),O(this[f],r,d,H),r.visible&&(S(this[f],n,r),Q(this[f],n,r,r.width,r.height),y=4/3*r.width,q=r.height,n.beginPath(),n.moveTo(r.x,r.y-q/2),n.bezierCurveTo(r.x-y/2,r.y-q/2,r.x-y/2,r.y+q/2,r.x,r.y+q/2),n.bezierCurveTo(r.x+y/2,r.y+q/2,r.x+y/2,r.y-q/2,r.x,r.y-q/2),U(this[f],n,r),r.closed=z,X(this[f],n,r));return this};d.fn.drawPolygon=function I(f){var d,r,y,q,t,p,l,k,m,u;for(d=0;d<this.length;d+=1)if(r=L(this[d]))if(y=new M(f),O(this[d],y,f,I),y.visible){S(this[d],
r,y);Q(this[d],r,y,2*y.radius);t=2*N/y.sides;p=t/2;q=p+N/2;l=y.radius*R(p);r.beginPath();for(u=0;u<y.sides;u+=1)k=y.x+y.radius*R(q),m=y.y+y.radius*T(q),r.lineTo(k,m),y.concavity&&(k=y.x+(l+-l*y.concavity)*R(q+p),m=y.y+(l+-l*y.concavity)*T(q+p),r.lineTo(k,m)),q+=t;U(this[d],r,y);y.closed=z;X(this[d],r,y)}return this};d.fn.drawSlice=function x(f){var r,y,q,t,p;for(r=0;r<this.length;r+=1)if(d(this[r]),y=L(this[r]))q=new M(f),O(this[r],q,f,x),q.visible&&(S(this[r],y,q),Q(this[r],y,q,2*q.radius),q.start*=
q._toRad,q.end*=q._toRad,q.start-=N/2,q.end-=N/2,q.start=Ga(q.start),q.end=Ga(q.end),q.end<q.start&&(q.end+=2*N),t=(q.start+q.end)/2,p=q.radius*q.spread*R(t),t=q.radius*q.spread*T(t),q.x+=p,q.y+=t,y.beginPath(),y.arc(q.x,q.y,q.radius,q.start,q.end,q.ccw),y.lineTo(q.x,q.y),U(this[r],y,q),q.closed=z,X(this[r],y,q));return this};d.fn.drawLine=function n(d){var f,q,t,p,l,k;for(f=0;f<this.length;f+=1)if(q=L(this[f]))if(t=new M(d),O(this[f],t,d,n),t.visible){S(this[f],q,t);Q(this[f],q,t,0);p=1;for(q.beginPath();z;)if(l=
t["x"+p],k=t["y"+p],l!==E&&k!==E)q.lineTo(l+t.x,k+t.y),p+=1;else break;p-=1;ga(this[f],q,t,t.x2+t.x,t.y2+t.y,t.x1+t.x,t.y1+t.y,t["x"+(p-1)]+t.x,t["y"+(p-1)]+t.y,t["x"+p]+t.x,t["y"+p]+t.y);U(this[f],q,t);X(this[f],q,t)}return this};d.fn.drawQuadratic=function r(f){var d,t,p,l,k,m,u,w;for(d=0;d<this.length;d+=1)if(t=L(this[d]))if(p=new M(f),O(this[d],p,f,r),p.visible){S(this[d],t,p);Q(this[d],t,p,0);l=2;t.beginPath();for(t.moveTo(p.x1+p.x,p.y1+p.y);z;)if(k=p["x"+l],m=p["y"+l],u=p["cx"+(l-1)],w=p["cy"+
(l-1)],k!==E&&m!==E&&u!==E&&w!==E)t.quadraticCurveTo(u+p.x,w+p.y,k+p.x,m+p.y),l+=1;else break;l-=1;ga(this[d],t,p,p.cx1+p.x,p.cy1+p.y,p.x1+p.x,p.y1+p.y,p["cx"+(l-1)]+p.x,p["cy"+(l-1)]+p.y,p["x"+l]+p.x,p["y"+l]+p.y);U(this[d],t,p);X(this[d],t,p)}return this};d.fn.drawBezier=function y(d){var f,p,l,k,m,u,w,s,C,A,D;for(f=0;f<this.length;f+=1)if(p=L(this[f]))if(l=new M(d),O(this[f],l,d,y),l.visible){S(this[f],p,l);Q(this[f],p,l,0);k=2;m=1;p.beginPath();for(p.moveTo(l.x1+l.x,l.y1+l.y);z;)if(u=l["x"+k],
w=l["y"+k],s=l["cx"+m],C=l["cy"+m],A=l["cx"+(m+1)],D=l["cy"+(m+1)],u!==E&&w!==E&&s!==E&&C!==E&&A!==E&&D!==E)p.bezierCurveTo(s+l.x,C+l.y,A+l.x,D+l.y,u+l.x,w+l.y),k+=1,m+=2;else break;k-=1;m-=2;ga(this[f],p,l,l.cx1+l.x,l.cy1+l.y,l.x1+l.x,l.y1+l.y,l["cx"+(m+1)]+l.x,l["cy"+(m+1)]+l.y,l["x"+k]+l.x,l["y"+k]+l.y);U(this[f],p,l);X(this[f],p,l)}return this};d.fn.drawVector=function q(f){var d,l,k,m,u,w,s,C,A,D,W,J;for(d=0;d<this.length;d+=1)if(l=L(this[d]))if(k=new M(f),O(this[d],k,f,q),k.visible){S(this[d],
l,k);Q(this[d],l,k,0);m=1;l.beginPath();A=W=s=k.x;D=J=C=k.y;for(l.moveTo(k.x,k.y);z;)if(u=k["a"+m],w=k["l"+m],u!==E&&w!==E)u*=k._toRad,u-=N/2,A=W,D=J,W+=w*R(u),J+=w*T(u),1===m&&(s=W,C=J),l.lineTo(W,J),m+=1;else break;ga(this[d],l,k,s,C,k.x,k.y,A,D,W,J);U(this[d],l,k);X(this[d],l,k)}return this};d.fn.drawText=function t(p){var l,k,m,u,w,s,C;for(l=0;l<this.length;l+=1)if(d(this[l]),k=L(this[l]))if(m=new M(p),O(this[l],m,p,t),m.visible){S(this[l],k,m);k.textBaseline=m.baseline;k.textAlign=m.align;Ia(k,
m);u=m.maxWidth!==f?Ka(k,m):m.text.toString().split("\n");Ja(this[l],k,m,u);p&&m.layer&&(p.width=m.width,p.height=m.height);Q(this[l],k,m,m.width,m.height);s=m.x;"left"===m.align?m.respectAlign?m.x+=m.width/2:s-=m.width/2:"right"===m.align&&(m.respectAlign?m.x-=m.width/2:s+=m.width/2);for(w=0;w<u.length;w+=1)k.shadowColor=m.shadowColor,C=m.y+w*m.height/u.length-(u.length-1)*m.height/u.length/2,k.fillText(u[w],s,C),"transparent"!==m.fillStyle&&(k.shadowColor="transparent"),k.strokeText(u[w],s,C);m._event&&
(k.beginPath(),k.rect(m.x-m.width/2,m.y-m.height/2,m.width,m.height),U(this[l],k,m),k.closePath());m._transformed&&k.restore()}Y=m;return this};d.fn.measureText=function(d){var f,l;f=this.getLayer(d);if(!f||f&&!f._layer)f=new M(d);if(d=L(this[0]))Ia(d,f),l=Ka(d,f),Ja(this[0],d,f,l);return f};d.fn.drawImage=function p(l){function k(l,p,m,k,s){return function(){var u=d(l);S(l,p,k);k.width===f&&k.sWidth===f&&(k.width=k.sWidth=D.width);k.height===f&&k.sHeight===f&&(k.height=k.sHeight=D.height);s&&(s.width=
k.width,s.height=k.height);k.sWidth!==f&&k.sHeight!==f&&k.sx!==f&&k.sy!==f?(k.width===f&&(k.width=k.sWidth),k.height===f&&(k.height=k.sHeight),k.cropFromCenter||(k.sx+=k.sWidth/2,k.sy+=k.sHeight/2),0>k.sy-k.sHeight/2&&(k.sy=k.sHeight/2),k.sy+k.sHeight/2>D.height&&(k.sy=D.height-k.sHeight/2),0>k.sx-k.sWidth/2&&(k.sx=k.sWidth/2),k.sx+k.sWidth/2>D.width&&(k.sx=D.width-k.sWidth/2),Q(l,p,k,k.width,k.height),p.drawImage(D,k.sx-k.sWidth/2,k.sy-k.sHeight/2,k.sWidth,k.sHeight,k.x-k.width/2,k.y-k.height/2,
k.width,k.height)):(Q(l,p,k,k.width,k.height),p.drawImage(D,k.x-k.width/2,k.y-k.height/2,k.width,k.height));p.beginPath();p.rect(k.x-k.width/2,k.y-k.height/2,k.width,k.height);U(l,p,k);p.closePath();k._transformed&&p.restore();va(p,m,k);P(u,m,s,"load");k.layer&&(s._masks=m.transforms.masks.slice(0),k._next&&u.drawLayers({clear:J,resetFire:z,index:k._next}))}}var m,u,w,s,C,N,D,W,K;for(u=0;u<this.length;u+=1)if(m=this[u],w=L(this[u]))s=A(this[u]),C=new M(l),N=O(this[u],C,l,p),C.visible&&(K=C.source,
W=K.getContext,K.src||W?D=K:K&&(ra[K]!==E?D=ra[K]:(D=new ta,D.src=K,ra[K]=D)),D&&(D.complete||W?k(m,w,s,C,N)():(d(D).bind("load",k(m,w,s,C,N)),D.src=D.src)));return this};d.fn.createPattern=function(p){function l(){s=m.createPattern(w,u.repeat);u.load&&u.load.call(k[0],s)}var k=this,m,u,w,s,C;(m=L(k[0]))?(u=new M(p),C=u.source,Z(C)?(w=d("<canvas />")[0],w.width=u.width,w.height=u.height,p=L(w),C.call(w,p),l()):(p=C.getContext,C.src||p?w=C:(w=new ta,w.src=C),w.complete||p?l():(d(w).bind("load",l),
w.src=w.src))):s=f;return s};d.fn.createGradient=function(d){var l,k=[],m,u,w,s,C,z,D;d=new M(d);if(l=L(this[0])){d.x1=d.x1||0;d.y1=d.y1||0;d.x2=d.x2||0;d.y2=d.y2||0;l=d.r1!==f||d.r2!==f?l.createRadialGradient(d.x1,d.y1,d.r1,d.x2,d.y2,d.r2):l.createLinearGradient(d.x1,d.y1,d.x2,d.y2);for(s=1;d["c"+s]!==E;s+=1)d["s"+s]!==E?k.push(d["s"+s]):k.push(f);m=k.length;k[0]===f&&(k[0]=0);k[m-1]===f&&(k[m-1]=1);for(s=0;s<m;s+=1){if(k[s]!==f){z=1;D=0;u=k[s];for(C=s+1;C<m;C+=1)if(k[C]!==f){w=k[C];break}else z+=
1;u>w&&(k[C]=k[s])}else k[s]===f&&(D+=1,k[s]=u+(w-u)/z*D);l.addColorStop(k[s],d["c"+(s+1)])}}else l=f;return l};d.fn.setPixels=function l(d){var m,u,w,s,C,z,D,A,E;for(u=0;u<this.length;u+=1)if(m=this[u],w=L(m)){s=new M(d);O(m,s,d,l);Q(this[u],w,s,s.width,s.height);if(s.width===f||s.height===f)s.width=m.width,s.height=m.height,s.x=s.width/2,s.y=s.height/2;if(0!==s.width&&0!==s.height){z=w.getImageData(s.x-s.width/2,s.y-s.height/2,s.width,s.height);D=z.data;E=D.length;if(s.each)for(A=0;A<E;A+=4)C={r:D[A],
g:D[A+1],b:D[A+2],a:D[A+3]},s.each.call(m,C,s),D[A]=C.r,D[A+1]=C.g,D[A+2]=C.b,D[A+3]=C.a;w.putImageData(z,s.x-s.width/2,s.y-s.height/2);w.restore()}}return this};d.fn.getCanvasImage=function(d,k){var m=this[0];k===E&&(k=1);return m&&m.toDataURL?m.toDataURL("image/"+d,k):f};d.fn.detectPixelRatio=function(f){var k,m,u,w,s,C,E;for(m=0;m<this.length;m+=1)k=this[m],d(this[m]),u=L(k),E=A(this[m]),E.scaled||(w=window.devicePixelRatio||1,s=u.webkitBackingStorePixelRatio||u.mozBackingStorePixelRatio||u.msBackingStorePixelRatio||
u.oBackingStorePixelRatio||u.backingStorePixelRatio||1,w/=s,1!==w&&(s=k.width,C=k.height,k.width=s*w,k.height=C*w,k.style.width=s+"px",k.style.height=C+"px",u.scale(w,w)),E.pixelRatio=w,E.scaled=z,f&&f.call(k,w));return this};d.support.canvas=d("<canvas />")[0].getContext;K.defaults=ha;K.setGlobalProps=S;K.transformShape=Q;K.detectEvents=U;K.closePath=X;d.jCanvas=K})(jQuery,document,Image,Array,Math,parseFloat,!0,!1,null);
